<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">
        body {
            margin: 0;
        }

    </style>
</head>
<body style="background: #eee;">
<script type="text/javascript">
    var maxRectangle = function(words) {
        var Node = function(value) {
            this.value = value;
            this.isEnd = false;
            this.next = [];
            this.get = function(value) {
                for(var i = 0; i < this.next.length; i++) {
                    if(value === this.next[i].value) {
                        return this.next[i];
                    }
                }
                return null;
            }
        }
        var Trie = function() {
            this.root = new Node();
            this.size = 0;
            this.add = function(word) {
                var cur = this.root, node;
                for(var i = 0; i < word.length; i++) {
                    node = cur.get(word[i]);
                    if(node === null) {
                        node = new Node(word[i]);
                        cur.next.push(node);
                    }
                    cur = node;
                }
                if(!cur.isEnd) {
                    cur.isEnd = true;
                    this.size++;
                }
            }
            this.search = function(word) {
                var cur = this.root, node;
                for(var i = 0; i < word.length; i++) {
                    node = cur.get(word[i]);
                    if(node === null) {
                        return false;
                    }
                    cur = node;
                }
                return cur.isEnd;
            }
        }

        words.sort(function(a, b) {
            return b.length - a.length;
        });

        var maxLen = words[0].length, maxArea = 0, maxNum = 0;

        var te = new Trie();

        for(var i = 0; i < words.length; i++) {
            if(words[i].length === maxLen) {
                maxNum++;
            }
            te.add(words[i]);
        }
        maxArea = maxNum * maxLen;

        var checkWord = function(path) {
            for(let i = 0; i < maxLen; i++) {
                if(!te.search(getCol(path, i))) {
                    return false;
                }
            }
            return true;
        }

        var getCol = function(path, n) {
            var col = [], num;
            for(var i = 0; i < path.length; i++) {
                col.push(path[i][n]);
            }
            return col.join('');
        }

        var path = [], rs = [], map = {};
        var dfs = function(index, len) {
            if(index >= 3 && checkWord(path)) {
				rs = [];
				for(var i = 0; i < path.length; i++) {
					rs.push(path[i]);
				}
                return;
            }
            for(var i = 0; i < words.length; i++) {
				//if(words[i].length === maxLen) {
					//path[index] = words[i];
					//dfs(index + 1);
				//}   
				// if(words.length > 1) {
					if(!map[i]) {
						//if(words[i].length === maxLen) {
							map[i] = true;
							path[index] = words[i];
							dfs(index + 1);
							map[i] = false;
                    	//}           
                	}
				// } else {
				// 	if(words[i].length === maxLen) {
				// 		path[index] = words[i];
				// 		dfs(index + 1);
				// 	}   
				// }
            }
        }

        dfs(0);

    	return rs;
    };

    //(["trh", "hea", "iar", "sld", "real", "hard", "this"]

    //console.log(maxRectangle(["real", "hard", "this"]));
    console.log(maxRectangle(["eat", "tea", "tan", "ate", "nat", "bat"]));
</script>
</body>
</html>
